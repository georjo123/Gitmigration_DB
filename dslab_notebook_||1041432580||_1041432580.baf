{"autoML":null,"errorMessage":null,"errorCode":null,"notebookModels":null,"message":null,"notebookModel":null,"success":true,"notebooks":null,"messageCode":null,"stackTrace":null,"notebookContent":"{\"sucess\":true,\"content\":{\"cells\":[{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.31928295481607183\"},\"execution_count\":null,\"source\":[\"%%bash\\npip install transformers===4.21.0\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.2357208357291749\"},\"execution_count\":null,\"source\":[\"gew\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.21675459789133944\"},\"execution_count\":null,\"source\":[\"%%bash\\n\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.6480850795304254\"},\"execution_count\":null,\"source\":[\"import pandas as pd\\nimport torch\\nimport numpy as np\\nfrom transformers import BertTokenizer, BertModel\\nfrom torch import nn\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.3227039277720467\"},\"execution_count\":null,\"source\":[\"df = pd.read_csv('https://storage.googleapis.com/dataset-uploader/bbc/bbc-text.csv')\\ndf.head()\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.7467866280809252\"},\"execution_count\":null,\"source\":[\"class BertClassifier(nn.Module):\\n\\n    def __init__(self, dropout=0.5):\\n\\n        super(BertClassifier, self).__init__()\\n\\n        self.bert = BertModel.from_pretrained('bert-base-cased')\\n        self.dropout = nn.Dropout(dropout)\\n        self.linear = nn.Linear(768, 5)\\n        self.relu = nn.ReLU()\\n\\n    def forward(self, input_id, mask):\\n\\n        _, pooled_output = self.bert(input_ids= input_id, attention_mask=mask,return_dict=False)\\n        dropout_output = self.dropout(pooled_output)\\n        linear_output = self.linear(dropout_output)\\n        final_layer = self.relu(linear_output)\\n\\n        return final_layer\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.07875942885621656\"},\"execution_count\":null,\"source\":[\"%%bash\\nls /nfsdir/uploadfiles/3306/859176961/model/876871681/\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.5240419121168054\"},\"execution_count\":null,\"source\":[\"import torch\\n# model = BertClassifier()\\nuse_cuda = torch.cuda.is_available()\\ndevice = torch.device(\\\"cuda\\\" if use_cuda else \\\"cpu\\\")\\nmodel =  torch.load('/nfsdir/uploadfiles/1112/684851203/model/873070593/BertClassification_4C.pth', map_location=device)\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.7454996317816751\"},\"execution_count\":null,\"source\":[\"import transformers\\ntransformers.__version__\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.25900667658574594\"},\"execution_count\":null,\"source\":[\"labels = {'business':0,\\n          'entertainment':1,\\n          'sport':2,\\n          'tech':3,\\n          'politics':4\\n          }\"],\"outputs\":[]},{\"cell_type\":\"code\",\"metadata\":{\"id\":\"1041432580_0.4120271904061059\"},\"execution_count\":null,\"source\":[\"from Notebook.DSNotebook.NotebookExecutor import NotebookExecutor\\nnb = NotebookExecutor()\\n# %%time\\nnb.predict(model = model, dataframe = df['text'].tolist()[:2], modeltype='nlp', labels={v: k for k, v in labels.items()})\\n #Choose modeltype 'ml' for machine learning models and 'cv' for computer vision model \\n #ex: For machine learning model nb.predict(model = model, modeltype = 'ml', dataframe = df) \\n #ex: For computer vision keras model nb.predict(model = model, modeltype = 'cv', imgs = imgs, imgsize = (28, 28), dim = 1, class_names = class_names) \\n #and for pytorch model(model = model, modeltype = 'cv', imgs = imgs, class_names = class_names) \\n #Note: incase any error in prediction user squeezed image data in keras\"],\"outputs\":[]}],\"metadata\":{},\"nbformat\":4,\"nbformat_minor\":2}}","autoMLs":null,"notebook":{"updatedBy":615907333,"data":"{\"datasets\":[],\"uncheckeddatasets\":[],\"kernalID\":\"\",\"Algorithms\":[]}","customComponentscript":null,"description":"","lastcommittedDate":1676977360668,"committedBy":615907333,"type":1,"uuid":"33061676977360768","spaceKey":"3306","migrationId":null,"lastUpdatedDate":1676977360768,"createdDate":1676977360668,"createdBy":615907333,"notebookName":"bertClassifierPrediction","id":1041432580,"projectId":1040515073,"isShared":null,"status":1}}